<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NuGet Gems: DeepEqual | Nicola Iarocci</title>
<meta name=keywords content><meta name=description content="This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:

An extensible deep comparison library for .NET.
I am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you&rsquo;d like to make sure that two instances of the same class are, indeed, equal. And no, you don&rsquo;t mean &ldquo;equal&rdquo; as in reference equality. That&rsquo;s easy to achieve with .NET. Most of the time, what you want is to check for value equality."><meta name=author content><link rel=canonical href=https://nicolaiarocci.com/nuget-gems-deepequal/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://nicolaiarocci.com/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nicolaiarocci.com/images/favicon16x16.ico><link rel=icon type=image/png sizes=32x32 href=https://nicolaiarocci.com/images/favicon32x32.ico><link rel=apple-touch-icon href=https://nicolaiarocci.com/images/favicon.ico><link rel=mask-icon href=https://nicolaiarocci.com/images/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://nicolaiarocci.com/nuget-gems-deepequal/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://nicolaiarocci.com/nuget-gems-deepequal/"><meta property="og:site_name" content="Nicola Iarocci"><meta property="og:title" content="NuGet Gems: DeepEqual"><meta property="og:description" content="This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:
An extensible deep comparison library for .NET.
I am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you’d like to make sure that two instances of the same class are, indeed, equal. And no, you don’t mean “equal” as in reference equality. That’s easy to achieve with .NET. Most of the time, what you want is to check for value equality."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-01-26T09:05:25+02:00"><meta property="article:modified_time" content="2019-01-26T09:05:25+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="NuGet Gems: DeepEqual"><meta name=twitter:description content="This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:

An extensible deep comparison library for .NET.
I am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you&rsquo;d like to make sure that two instances of the same class are, indeed, equal. And no, you don&rsquo;t mean &ldquo;equal&rdquo; as in reference equality. That&rsquo;s easy to achieve with .NET. Most of the time, what you want is to check for value equality."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nicolaiarocci.com/post/"},{"@type":"ListItem","position":2,"name":"NuGet Gems: DeepEqual","item":"https://nicolaiarocci.com/nuget-gems-deepequal/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NuGet Gems: DeepEqual","name":"NuGet Gems: DeepEqual","description":"This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:\nAn extensible deep comparison library for .NET.\nI am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you\u0026rsquo;d like to make sure that two instances of the same class are, indeed, equal. And no, you don\u0026rsquo;t mean \u0026ldquo;equal\u0026rdquo; as in reference equality. That\u0026rsquo;s easy to achieve with .NET. Most of the time, what you want is to check for value equality.\n","keywords":[],"articleBody":"This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:\nAn extensible deep comparison library for .NET.\nI am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you’d like to make sure that two instances of the same class are, indeed, equal. And no, you don’t mean “equal” as in reference equality. That’s easy to achieve with .NET. Most of the time, what you want is to check for value equality.\nNow, when it comes to value equality, there are a few things you can do in .NET: override Object.Equals() (which, by the way, if the type is a reference type, by default will check for reference equality), implement the IEquatable interface, override the == operator or, most commonly, a combination of these techniques.\nThe problem with this is, it can get messy real quick, especially if you are checking instances of non-sealed classes. Quoting the documentation’s Note for Callers:\nWhen you call the Equals method to test for equality, you should know whether the current instance overrides Object. Equals and understand how a particular call to an Equals method is resolved. Otherwise, you may be performing a test for equality that is different from what you intended, and the method may return an unexpected value (source).\nSometimes you don’t know the inner details about the classes you are playing with. Also, at least in my case, many times I am performing these checks in my tests, not in the application itself. Implementing all this comparison logic just for the sake of testing would be, in my opinion, overkill.\nSometimes (most of the times?), you only need to make sure two instances are equal by value, and very deeply at that. DeepEqual comes in handy:\nbool result = object1.IsDeepEqual(object2); Simple as that. Again, I find this package invaluable especially when doing tests. Actually, I suspect I am only using it in my test. When used inside a test, you can call ShouldDeepEqual:\nobject1.ShouldDeepEqual(object2); This method throws an exception with a detailed description of the differences between the two objects. You can pass a custom comparison as the second argument to the ShouldDeepEqual method, to override the default behavior. You can also customize the behavior inline, using the WithDeepEqual extension method:\nobject1.WithDeepEqual(object2) .SkipDefault() .IgnoreSourceProperty(x =\u003e x.Id) .Assert() I have been using this package for a long time. At some point, I even submitted a pull request to port it to NetStandard. Despite a lot of people loving it, the pull request was left there unnoticed for quite some time. I was asked to release a fork, I declined (somebody else did). In the end, the package author came back from the void to release a new, NetStandard compatible, update, which is fantastic. Sometimes in open source, it takes a little patience.\nEnjoy.\nDeepEqual Join the newsletter to get an email alert when a new post surfaces on this site. If you want to get in touch, I am @nicolaiarocci on twitter.\n","wordCount":"513","inLanguage":"en","datePublished":"2019-01-26T09:05:25+02:00","dateModified":"2019-01-26T09:05:25+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nicolaiarocci.com/nuget-gems-deepequal/"},"publisher":{"@type":"Organization","name":"Nicola Iarocci","logo":{"@type":"ImageObject","url":"https://nicolaiarocci.com/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nicolaiarocci.com/ accesskey=h title="Nicola Iarocci (Alt + H)"><img src=https://nicolaiarocci.com/images/avatar.png alt aria-label=logo height=35>Nicola Iarocci</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nicolaiarocci.com/about/ title=about><span>about</span></a></li><li><a href=https://nicolaiarocci.com/opensource/ title=code><span>code</span></a></li><li><a href=https://nicolaiarocci.com/speaking/ title=speaking><span>speaking</span></a></li><li><a href=https://nicolaiarocci.com/books-i-have-read/ title=library><span>library</span></a></li><li><a href=https://buttondown.email/nicolaiarocci title=newsletter><span>newsletter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://nicolaiarocci.com/index.xml title=rss><span>rss</span></a></li><li><a href=https://nicolaiarocci.com/archives/ title=archive><span>archive</span></a></li><li><a href=https://nicolaiarocci.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">NuGet Gems: DeepEqual</h1><div class=post-meta><span title='2019-01-26 09:05:25 +0200 +0200'>January 26, 2019</span></div></header><div class=post-content><p>This handy little package does one simple thing, and it does it well. According to its description, DeepEqual is:</p><blockquote><p>An extensible deep comparison library for .NET.</p></blockquote><p>I am sure you too have come across this a few times. You have some code that shuffles around objects, and at some point, you&rsquo;d like to make sure that two instances of the same class are, indeed, equal. And no, you don&rsquo;t mean &ldquo;equal&rdquo; as in <a href=https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/equality-comparisons#reference-equality>reference equality</a>. That&rsquo;s easy to achieve with .NET. Most of the time, what you want is to check for <a href=https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/how-to-define-value-equality-for-a-type>value equality</a>.</p><p>Now, when it comes to value equality, there are a few things you can do in .NET: override <code>Object.Equals()</code> (which, by the way, if the type is a reference type, by default will check for reference equality), implement the <code>IEquatable</code> interface, override the <code>==</code> operator or, most commonly, a combination of these techniques.</p><p>The problem with this is, it can get messy real quick, especially if you are checking instances of non-sealed classes. Quoting the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.equals?view=netframework-4.7.2">documentation</a>&rsquo;s <em>Note for Callers</em>:</p><blockquote><p>When you call the Equals method to test for equality, you should know whether the current instance overrides Object. Equals and understand how a particular call to an Equals method is resolved. Otherwise, you may be performing a test for equality that is different from what you intended, and the method may return an unexpected value (source).</p></blockquote><p>Sometimes you don&rsquo;t know the inner details about the classes you are playing with. Also, at least in my case, many times I am performing these checks in my tests, not in the application itself. Implementing all this comparison logic just for the sake of testing would be, in my opinion, overkill.</p><p>Sometimes (most of the times?), you only need to make sure two instances are equal by value, and very deeply at that. DeepEqual comes in handy:</p><pre><code>bool result = object1.IsDeepEqual(object2);
</code></pre><p>Simple as that. Again, I find this package invaluable especially when doing tests. Actually, I suspect I am <em>only</em> using it in my test. When used inside a test, you can call <code>ShouldDeepEqual</code>:</p><pre><code>object1.ShouldDeepEqual(object2);
</code></pre><p>This method throws an exception with a detailed description of the differences between the two objects. You can pass a custom comparison as the second argument to the <code>ShouldDeepEqual</code> method, to override the default behavior. You can also customize the behavior inline, using the <code>WithDeepEqual</code> extension method:</p><pre><code>object1.WithDeepEqual(object2)
   .SkipDefault&lt;MyEntity&gt;()
   .IgnoreSourceProperty(x =&gt; x.Id)
   .Assert()
</code></pre><p>I have been using this package for a long time. At some point, I even <a href=https://github.com/jamesfoster/DeepEqual/pull/27>submitted a pull request</a> to port it to NetStandard. Despite a lot of people loving it, the pull request was left there unnoticed for quite some time. I was asked to release a fork, I declined (somebody else did). In the end, the package author came back from the void to release a new, NetStandard compatible, update, which is fantastic. Sometimes in open source, it takes a little patience.</p><p>Enjoy.</p><ul><li><a href=https://github.com/jamesfoster/DeepEqual>DeepEqual</a></li></ul><p><em>Join the <a href=http://eepurl.com/b-_Pzz>newsletter</a> to get an email alert when a new post surfaces on
this site. If you want to get in touch, I am @<a href=http://twitter.com/nicolaiarocci>nicolaiarocci</a> on twitter.</em></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>Produced / Written / Maintained by <a href=/>Nicola Iarocci</a> since 2010</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>