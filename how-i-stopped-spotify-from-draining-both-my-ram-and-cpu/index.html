<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How I stopped Spotify from draining both my RAM and CPU | Nicola Iarocci</title>
<meta name=keywords content="spotify,open-source"><meta name=description content="A few days ago, I was browsing my Twitter feed when a suggestion from my
friend @flaper87 caught my attention:

On my &ldquo;comfortably old&rdquo; MacBook Pro1, Spotify has been an absolute hog. The
simple act of opening it will require three hundred MBs. That&rsquo;s a remarkable
amount of memory for staying idle and doing nothing useful. Let it play for
a few hours, and have fun glancing at CPU and RAM usage ramping up like there&rsquo;s
no tomorrow. Just for the record, here&rsquo;s Spotify memory usage at launch:"><meta name=author content><link rel=canonical href=https://nicolaiarocci.com/how-i-stopped-spotify-from-draining-both-my-ram-and-cpu/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://nicolaiarocci.com/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nicolaiarocci.com/images/favicon16x16.ico><link rel=icon type=image/png sizes=32x32 href=https://nicolaiarocci.com/images/favicon32x32.ico><link rel=apple-touch-icon href=https://nicolaiarocci.com/images/favicon.ico><link rel=mask-icon href=https://nicolaiarocci.com/images/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://nicolaiarocci.com/how-i-stopped-spotify-from-draining-both-my-ram-and-cpu/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://nicolaiarocci.com/how-i-stopped-spotify-from-draining-both-my-ram-and-cpu/"><meta property="og:site_name" content="Nicola Iarocci"><meta property="og:title" content="How I stopped Spotify from draining both my RAM and CPU"><meta property="og:description" content="A few days ago, I was browsing my Twitter feed when a suggestion from my friend @flaper87 caught my attention:
On my “comfortably old” MacBook Pro1, Spotify has been an absolute hog. The simple act of opening it will require three hundred MBs. That’s a remarkable amount of memory for staying idle and doing nothing useful. Let it play for a few hours, and have fun glancing at CPU and RAM usage ramping up like there’s no tomorrow. Just for the record, here’s Spotify memory usage at launch:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-09-05T07:05:25+01:00"><meta property="article:modified_time" content="2022-09-05T07:05:25+01:00"><meta property="article:tag" content="Spotify"><meta property="article:tag" content="Open Source"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I stopped Spotify from draining both my RAM and CPU"><meta name=twitter:description content="A few days ago, I was browsing my Twitter feed when a suggestion from my
friend @flaper87 caught my attention:

On my &ldquo;comfortably old&rdquo; MacBook Pro1, Spotify has been an absolute hog. The
simple act of opening it will require three hundred MBs. That&rsquo;s a remarkable
amount of memory for staying idle and doing nothing useful. Let it play for
a few hours, and have fun glancing at CPU and RAM usage ramping up like there&rsquo;s
no tomorrow. Just for the record, here&rsquo;s Spotify memory usage at launch:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nicolaiarocci.com/post/"},{"@type":"ListItem","position":2,"name":"How I stopped Spotify from draining both my RAM and CPU","item":"https://nicolaiarocci.com/how-i-stopped-spotify-from-draining-both-my-ram-and-cpu/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How I stopped Spotify from draining both my RAM and CPU","name":"How I stopped Spotify from draining both my RAM and CPU","description":"A few days ago, I was browsing my Twitter feed when a suggestion from my friend @flaper87 caught my attention:\nOn my \u0026ldquo;comfortably old\u0026rdquo; MacBook Pro1, Spotify has been an absolute hog. The simple act of opening it will require three hundred MBs. That\u0026rsquo;s a remarkable amount of memory for staying idle and doing nothing useful. Let it play for a few hours, and have fun glancing at CPU and RAM usage ramping up like there\u0026rsquo;s no tomorrow. Just for the record, here\u0026rsquo;s Spotify memory usage at launch:\n","keywords":["spotify","open-source"],"articleBody":"A few days ago, I was browsing my Twitter feed when a suggestion from my friend @flaper87 caught my attention:\nOn my “comfortably old” MacBook Pro1, Spotify has been an absolute hog. The simple act of opening it will require three hundred MBs. That’s a remarkable amount of memory for staying idle and doing nothing useful. Let it play for a few hours, and have fun glancing at CPU and RAM usage ramping up like there’s no tomorrow. Just for the record, here’s Spotify memory usage at launch:\nSo what exactly is spotifyd? An open source Spotify client running as a UNIX daemon.\nSpotifyd streams music just like the official client, but is more lightweight and supports more platforms. Spotifyd also supports the Spotify Connect protocol, which makes it show up as a device that can be controlled from the official clients2.\nSlow Saturday morning, I decided to give the spotifyd/spotify-tui combo a try. Setting up spotifyd on a Mac with homebrew is as simple as typing brew install spotifyd and then brew services start spotifyd to let it run as a service, or one can opt to launch it as a stand-alone with spotifyd --no-daemon.\nAs I quickly learned, on a Mac, you need to edit the default configuration file to update a couple of settings, as reported on the wiki. Namely, I had to set backend = 'portaudio' and volume_controller = 'softvol'. While at it, I also set use_keyring = true to avoid storing my Spotify password in the file. Here’s my current configuration settings:\n[global] username = \"\" use_keyring = true # On Linux, set both values to 'alsa' backend = \"portaudio\" volume_controller = \"softvol\" bitrate = 320 volume_normalisation = true normalisation_pregain = -10 # If set to true, audio data does NOT get cached. no_audio_cache = false cache_path = \"/Application Support/Spotify/PersistentCache/Storage\" One minor annoyance that doesn’t prevent the server from running as intended and is only noticeable when I run spotifyd as a stand-alone app is a recurring and rather obscure “No route to host” warning message. There’s an open ticket about it. Other than that, spotifyd has been bliss. Most remarkably, this is the memory usage after a few hours of non-stop streaming:\nQuite an achievement, considering that we started at 300+ MBs.\nI also installed spotify-tui in an attempt to use it as a replacement for the official client. As much as I’d love to use it (I love its UI/UX), I can’t say I’m happy with it. It sometimes reports a server disconnect when, in fact, the underlying spotifyd service is running fine (and I can connect and play with it from the official client). Secondly, it is sluggish sometimes. Further investigation revealed that the project is not actively maintained. For the time being, I’m connecting to spotifyd from the official iPhone app. I get the lightweight service with the added benefit that I don’t have to switch windows when I want to interact with Spotify.\nmid-2012. Yes, I know. It’s due for replacement later this year, when the M2 MacBook Pro 14\" is announced. ↩︎\nSpotifyd requires a Spotify Premium account. [rss]: https://nicolaiarocci.com/index.xml [tw]: http://twitter.com/nicolaiarocci [nl]: https://buttondown.email/nicolaiarocci ↩︎\n","wordCount":"524","inLanguage":"en","datePublished":"2022-09-05T07:05:25+01:00","dateModified":"2022-09-05T07:05:25+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nicolaiarocci.com/how-i-stopped-spotify-from-draining-both-my-ram-and-cpu/"},"publisher":{"@type":"Organization","name":"Nicola Iarocci","logo":{"@type":"ImageObject","url":"https://nicolaiarocci.com/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nicolaiarocci.com/ accesskey=h title="Nicola Iarocci (Alt + H)"><img src=https://nicolaiarocci.com/images/avatar.png alt aria-label=logo height=35>Nicola Iarocci</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buttondown.email/nicolaiarocci title=subscribe><span>subscribe</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://nicolaiarocci.com/opensource/ title=code><span>code</span></a></li><li><a href=https://nicolaiarocci.com/speaking/ title=speaking><span>speaking</span></a></li><li><a href=https://nicolaiarocci.com/books-i-have-read/ title=library><span>library</span></a></li><li><a href=https://nicolaiarocci.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://nicolaiarocci.com/archives/ title=archive><span>archive</span></a></li><li><a href=https://nicolaiarocci.com/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How I stopped Spotify from draining both my RAM and CPU</h1><div class=post-meta><span title='2022-09-05 07:05:25 +0100 +0100'>September 5, 2022</span></div></header><div class=post-content><p>A few days ago, I was browsing my Twitter feed when a <a href=https://twitter.com/flaper87/status/1564899493572710400>suggestion</a> from my
friend <a href=https://twitter.com/flaper87>@flaper87</a> caught my attention:</p><p><img loading=lazy src=/images/flaper87-on-spotifyd.png></p><p>On my &ldquo;comfortably old&rdquo; MacBook Pro<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, Spotify has been an absolute hog. The
simple act of opening it will require three hundred MBs. That&rsquo;s a remarkable
amount of memory for staying idle and doing nothing useful. Let it play for
a few hours, and have fun glancing at CPU and RAM usage ramping up like there&rsquo;s
no tomorrow. Just for the record, here&rsquo;s Spotify memory usage at launch:</p><p><img loading=lazy src=/images/spotify-memory-usage.png></p><p>So what exactly is <a href=https://github.com/Spotifyd/spotifyd>spotifyd</a>? An open source Spotify client
running as a UNIX daemon.</p><blockquote><p>Spotifyd streams music just like the official client, but is more lightweight
and supports more platforms. Spotifyd also supports the Spotify Connect
protocol, which makes it show up as a device that can be controlled from the
official clients<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p></blockquote><p>Slow Saturday morning, I decided to give the spotifyd/spotify-tui combo a try.
Setting up spotifyd on a Mac with homebrew is as simple as typing <code>brew install spotifyd</code> and then <code>brew services start spotifyd</code> to let it run as a service,
or one can opt to launch it as a stand-alone with <code>spotifyd --no-daemon</code>.</p><p>As I quickly learned, on a Mac, you need to edit the default configuration file
to update a couple of settings, as reported on the wiki. Namely, I had to set
<code>backend = 'portaudio'</code> and <code>volume_controller = 'softvol'</code>. While at it,
I also set <code>use_keyring = true</code> to avoid storing my Spotify password in the
file. Here&rsquo;s my current configuration settings:</p><pre><code>[global]
username = &quot;&lt;USERNAME&gt;&quot;
use_keyring = true

# On Linux, set both values to 'alsa'
backend = &quot;portaudio&quot;          
volume_controller = &quot;softvol&quot;  

bitrate = 320
volume_normalisation = true
normalisation_pregain = -10

# If set to true, audio data does NOT get cached.
no_audio_cache = false
cache_path = &quot;&lt;USER_LIBRARY&gt;/Application Support/Spotify/PersistentCache/Storage&quot;
</code></pre><p>One minor annoyance that doesn&rsquo;t prevent the server from running as intended
and is only noticeable when I run spotifyd as a stand-alone app is a recurring
and rather obscure &ldquo;No route to host&rdquo; warning message. There&rsquo;s an <a href=https://github.com/Spotifyd/spotifyd/issues/1026>open
ticket</a> about it. Other than that, spotifyd has been bliss. Most remarkably,
this is the memory usage after a few hours of non-stop streaming:</p><p><img loading=lazy src=/images/spotifyd-memory-usage.png></p><p>Quite an achievement, considering that we started at 300+ MBs.</p><p>I also installed <a href=https://github.com/Rigellute/spotify-tui>spotify-tui</a> in an attempt to use it as a replacement for
the official client. As much as I&rsquo;d love to use it (I love its UI/UX), I can&rsquo;t
say I&rsquo;m happy with it. It sometimes reports a server disconnect when, in fact,
the underlying spotifyd service is running fine (and I can connect and play
with it from the official client). Secondly, it is sluggish sometimes. Further
investigation revealed that the project is <a href=https://github.com/Rigellute/spotify-tui/issues/1000>not actively maintained</a>. For
the time being, I&rsquo;m connecting to spotifyd from the official iPhone app. I get
the lightweight service with the added benefit that I don&rsquo;t have to switch
windows when I want to interact with Spotify.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>mid-2012. Yes, I know. It&rsquo;s due for replacement later this year, when the M2 MacBook Pro 14" is announced.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Spotifyd requires a Spotify Premium account.
[rss]: <a href=https://nicolaiarocci.com/index.xml>https://nicolaiarocci.com/index.xml</a>
[tw]: <a href=http://twitter.com/nicolaiarocci>http://twitter.com/nicolaiarocci</a>
[nl]: <a href=https://buttondown.email/nicolaiarocci>https://buttondown.email/nicolaiarocci</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://nicolaiarocci.com/tags/spotify/>Spotify</a></li><li><a href=https://nicolaiarocci.com/tags/open-source/>Open Source</a></li></ul><nav class=paginav><a class=prev href=https://nicolaiarocci.com/eve-2.0.1-released/><span class=title>« Prev</span><br><span>Eve 2.0.1 released</span>
</a><a class=next href=https://nicolaiarocci.com/the-women-who-built-grunge/><span class=title>Next »</span><br><span>The Women Who Built Grunge</span></a></nav></footer></article></main><footer class=footer><span>Produced / Written / Maintained by <a href=/>Nicola Iarocci</a> since 2010</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>