<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Write libraries, not services? Not so fast | Nicola Iarocci</title>
<meta name=keywords content="links,programming,infrastructure"><meta name=description content="Write libraries instead of services is an interesting article I read a while ago. I cannot get it off my head. In an attempt to clear up my mind, I decided to sit down and write about it. I have been writing libraries for a good part of my life. Most of my earlier dev-work resides on thousands of computers in the form of libraries. More recently, I have been writing and deploying remote services."><meta name=author content><link rel=canonical href=https://nicolaiarocci.com/write-libraries-not-services-not-so-fast/><link crossorigin=anonymous href=/assets/css/stylesheet.f0568d4df87da526a07cdd5f492b4a146e3fa93d5ee950200eaafb2bb50d6fd8.css integrity="sha256-8FaNTfh9pSagfN1fSStKFG4/qT1e6VAgDqr7K7UNb9g=" rel="preload stylesheet" as=style><link rel=icon href=https://nicolaiarocci.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nicolaiarocci.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nicolaiarocci.com/favicon-32x32.png><link rel=apple-touch-icon href=https://nicolaiarocci.com/apple-touch-icon.png><link rel=mask-icon href=https://nicolaiarocci.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Write libraries, not services? Not so fast"><meta property="og:description" content="Write libraries instead of services is an interesting article I read a while ago. I cannot get it off my head. In an attempt to clear up my mind, I decided to sit down and write about it. I have been writing libraries for a good part of my life. Most of my earlier dev-work resides on thousands of computers in the form of libraries. More recently, I have been writing and deploying remote services."><meta property="og:type" content="article"><meta property="og:url" content="https://nicolaiarocci.com/write-libraries-not-services-not-so-fast/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-25T07:05:25+01:00"><meta property="article:modified_time" content="2021-03-25T07:05:25+01:00"><meta property="og:site_name" content="Nicola Iarocci"><meta name=twitter:card content="summary"><meta name=twitter:title content="Write libraries, not services? Not so fast"><meta name=twitter:description content="Write libraries instead of services is an interesting article I read a while ago. I cannot get it off my head. In an attempt to clear up my mind, I decided to sit down and write about it. I have been writing libraries for a good part of my life. Most of my earlier dev-work resides on thousands of computers in the form of libraries. More recently, I have been writing and deploying remote services."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://nicolaiarocci.com/post/"},{"@type":"ListItem","position":3,"name":"Write libraries, not services? Not so fast","item":"https://nicolaiarocci.com/write-libraries-not-services-not-so-fast/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Write libraries, not services? Not so fast","name":"Write libraries, not services? Not so fast","description":"Write libraries instead of services is an interesting article I read a while ago. I cannot get it off my head. In an attempt to clear up my mind, I decided to sit down and write about it. I have been writing libraries for a good part of my life. Most of my earlier dev-work resides on thousands of computers in the form of libraries. More recently, I have been writing and deploying remote services.","keywords":["links","programming","infrastructure"],"articleBody":"Write libraries instead of services is an interesting article I read a while ago. I cannot get it off my head. In an attempt to clear up my mind, I decided to sit down and write about it. I have been writing libraries for a good part of my life. Most of my earlier dev-work resides on thousands of computers in the form of libraries. More recently, I have been writing and deploying remote services. Libraries versus Services is a topic I care about.\nLet’s jump into the article.\nA service has constant administration costs which are paid by the service provider. A properly designed library instead moves these costs to the users of the library.\nThis ignores the issue of support. You are going to have to support your users. Support comes at a cost. I would argue that, given the distributed nature of libraries, supporting them can become very costly. Your library is probably residing in a myriad of diverse, local environments. Issues are hard to replicate or reason about. It is hard to isolate your own code from the surrounding environment.\nPeople say, “services are easy because you can upgrade them centrally, so you can avoid slow-to-upgrade users making everyone’s lives worse.” But this assumes that slow-to-upgrade users can have negative effects on everyone else. If one user can’t have a negative impact on other users, then you don’t care if some users are slow to upgrade; they’re only hurting themselves.\nAgain, support. Those slow-to-upgrade users are going to not just hurt but torture your support service with years-old obsolete issues. If you think it’s the user’s responsibility to keep dependencies up to date, good luck with that. That assumes that developers adopting the library control their deployments, which isn’t often the case. They might employ the library in a desktop application distributed to dozens (or thousands) of end-users. It could be next to impossible for them to make sure that all their deployments are up to speed. Old versions are a pain point and one (if not the most) significant cost factor. Maintaining a service comes at a cost too, and you’ll likely need to offer some sort of support there as well. A service, however, ensures that all your users are on the same version, which tremendously reduces the support effort.\nWhen weighting costs, support must be factored in, along with all the rest: development, maintenance, distribution, documentation, etc. Maybe the article’s author has the luxury of not having to deal with support himself. Still, there’s someone else at his company who has to do that.\nA service, on the other hand, represents a single point of failure. If it goes down, all users are immediately affected1. By contrast, a nasty bug in your library will only affect the unlucky users on that version. Now, this makes a significant advantage for distributed libraries.\nYour service, however, will talk to all languages via REST, GraphQL, or any other interface of choice. The library will usually speak just one language. Yes, you might provide language-specific SDKs for your service, but that’s just an option.\nDo you need to hold state? If you do, most of the time, a service will be a better option. With state comes responsibility, however. You have to ensure regular backups, resilience, and maintenance, all of them at a cost.\nThe author suggests a few approaches to circumventing library limitations. Some are reasonable, like dynamic linking where it is applicable (not all stacks support it). Others, quite frankly, I don’t understand.\nMany factors influence the choice between service and library, use case and prevailing circumstances being the main ones. I am not even sure they are comparable, as they tend to solve different problems.\nSubscribe to the newsletter, the RSS feed, or follow @nicolaiarocci on Twitter\nI know first hand. We’ve recently been impacted by a catastrophic event that happened to one of our providers. Our services went down and, with them, a good part of our users. How we overcame the situation and what we learned in the process would probably be worth telling, maybe in a future article. ↩︎\n","wordCount":"687","inLanguage":"en","datePublished":"2021-03-25T07:05:25+01:00","dateModified":"2021-03-25T07:05:25+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nicolaiarocci.com/write-libraries-not-services-not-so-fast/"},"publisher":{"@type":"Organization","name":"Nicola Iarocci","logo":{"@type":"ImageObject","url":"https://nicolaiarocci.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nicolaiarocci.com accesskey=h title="Home (Alt + H)"><img src=https://nicolaiarocci.com/images/avatar.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nicolaiarocci.com/opensource/ title=code><span>code</span></a></li><li><a href=https://nicolaiarocci.com/speaking/ title=conferences><span>conferences</span></a></li><li><a href=https://nicolaiarocci.com/books-i-have-read/ title=library><span>library</span></a></li><li><a href=https://nicolaiarocci.com/archives/ title=archive><span>archive</span></a></li><li><a href=https://nicolaiarocci.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Write libraries, not services? Not so fast</h1><div class=post-meta><span title='2021-03-25 07:05:25 +0100 CET'>March 25, 2021</span></div></header><div class=post-content><p><a href=http://catern.com/services.html>Write libraries instead of services</a> is an interesting article I read
a while ago. I cannot get it off my head. In an attempt to clear up my mind,
I decided to sit down and write about it. I have been writing libraries for
a good part of my life. Most of my earlier dev-work resides on thousands of
computers in the form of libraries. More recently, I have been writing and
deploying remote services. Libraries versus Services is a topic I care about.</p><p>Let&rsquo;s jump into the article.</p><blockquote><p>A service has constant administration costs which are paid by the service
provider. A properly designed library instead moves these costs to the users
of the library.</p></blockquote><p>This ignores the issue of support. You are going to have to support your users.
Support comes at a cost. I would argue that, given the distributed nature of
libraries, supporting them can become <em>very</em> costly. Your library is probably
residing in a myriad of diverse, local environments. Issues are hard to
replicate or reason about. It is hard to isolate your own code from the
surrounding environment.</p><blockquote><p>People say, &ldquo;services are easy because you can upgrade them centrally, so you
can avoid slow-to-upgrade users making everyone&rsquo;s lives worse.&rdquo; But this
assumes that slow-to-upgrade users can have negative effects on everyone
else. If one user can&rsquo;t have a negative impact on other users, then you don&rsquo;t
care if some users are slow to upgrade; they&rsquo;re only hurting themselves.</p></blockquote><p>Again, support. Those slow-to-upgrade users are going to not just hurt but
torture your support service with years-old obsolete issues. If you think it&rsquo;s
the user&rsquo;s responsibility to keep dependencies up to date, good luck with that.
That assumes that developers adopting the library control their deployments,
which isn&rsquo;t often the case. They might employ the library in a desktop
application distributed to dozens (or thousands) of end-users. It could be next
to impossible for them to make sure that all their deployments are up to speed.
Old versions are a pain point and one (if not the most) significant cost
factor. Maintaining a service comes at a cost too, and you&rsquo;ll likely need to
offer some sort of support there as well. A service, however, ensures that all
your users are on the same version, which tremendously reduces the support
effort.</p><p>When weighting costs, support must be factored in, along with all the rest:
development, maintenance, distribution, documentation, etc. Maybe the
article&rsquo;s author has the luxury of not having to deal with support himself.
Still, there&rsquo;s someone else at his company who has to do that.</p><p>A service, on the other hand, represents a single point of failure. If it goes
down, all users are immediately affected<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. By contrast, a nasty bug in your
library will only affect the unlucky users on that version. Now, <em>this</em> makes
a significant advantage for distributed libraries.</p><p>Your service, however, will talk to all languages via REST, GraphQL, or any
other interface of choice. The library will usually speak just one language.
Yes, you might provide language-specific SDKs for your service, but that&rsquo;s just
an option.</p><p>Do you need to hold state? If you do, most of the time, a service will be
a better option. With state comes responsibility, however. You have to
ensure regular backups, resilience, and maintenance, all of them at a cost.</p><p>The author suggests a few approaches to circumventing library limitations. Some
are reasonable, like dynamic linking where it is applicable (not all stacks
support it). Others, quite frankly, I don&rsquo;t understand.</p><p>Many factors influence the choice between service and library, use case and
prevailing circumstances being the main ones. I am not even sure they are
comparable, as they tend to solve different problems.</p><p><em>Subscribe to the <a href=https://nicolaiarocci.substack.com>newsletter</a>, the <a href=https://nicolaiarocci.com/index.xml>RSS feed</a>, or follow @<a href=http://twitter.com/nicolaiarocci>nicolaiarocci</a> on Twitter</em></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I know first hand. We&rsquo;ve recently been impacted by a catastrophic event that happened to one of our providers. Our services went down and, with them, a good part of our users. How we overcame the situation and what we learned in the process would probably be worth telling, maybe in a future article.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://nicolaiarocci.com/tags/links/>links</a></li><li><a href=https://nicolaiarocci.com/tags/programming/>programming</a></li><li><a href=https://nicolaiarocci.com/tags/infrastructure/>infrastructure</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://nicolaiarocci.com>Nicola Iarocci</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>